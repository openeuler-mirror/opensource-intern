"use strict";(self["webpackChunkdockyard"]=self["webpackChunkdockyard"]||[]).push([[8],{3008:function(e,a,t){t.r(a),t.d(a,{default:function(){return R}});var l=t(5298),s=(t(1959),t(8179)),i=(t(2040),t(3396)),n=t(2268),m=t(4870),r=t(9811),g=t(6629),o=t(7139),u=t(1477);const c=(0,o.Q_)("image",{state:()=>({library_choosed:"",images:[],images_total:0}),actions:{async GetImages(e,a,t){const l=await(0,u.Hk)(e,a,t);if(200!=l.status)return Promise.reject("get images failure");this.images=l.data},async DelImage(e){const a=await(0,u.KI)(e);return 200!=a.status?Promise.reject("delete image failure"):(this.images=this.images.filter((a=>a.name!=e)),!0)},async GetImageTotal(e){const a=await(0,u.pl)(e);return 200!=a.status?Promise.reject("get library total failure"):(this.images_total=a.data.count,!0)},async DelTag(e,a){const t=await(0,u.Qg)(e,a);if(200!=t.status)return Promise.reject("del tag failure");this.images=this.images.map((t=>(t.name==e&&(t.tags=t.tags.filter((e=>e.tag!=a))),t)))},async GetTagTotal(e){const a=await(0,u.d5)(e);if(200!=a.status)return Promise.reject("get tag total failure");this.images=this.images.map((t=>(t.name==e&&(t.tags_count=a.data.count),t)))},async UpdateTags(e,a,t){const l=await(0,u.Sp)(e,a,t);if(200!=l.status)return Promise.reject("get tag list failure");this.images=this.images.map((a=>(a.name==e&&(a.tags=l.data),a)))}},getters:{getName:e=>e.images.map((e=>e.name)),getCharData:e=>e.images.map((e=>({name:e.name,value:e.size})))}}),d={class:"dialog-footer"};var w={__name:"DelImage",setup(e){const a=c(),t=(0,m.iH)(!1);let o=(0,m.qj)({});r.Z.on("delete_image",(e=>{t.value=!0,o.name=e.name,o.size=e.size,o.tags_count=e.tags_count,o.first_creation=e.timeinfo.first_creation,o.last_creation=e.timeinfo.last_creation,o.last_push=e.timeinfo.last_push,o.last_pull=e.timeinfo.last_pull}));const u=async e=>{console.log("name--",e),a.DelImage(e).then((()=>{t.value=!1,g.z8.success("Delete Success")})).catch((()=>{t.value=!1,g.z8.error("Delete Failure")}))};return(e,a)=>{const r=s.mi,g=l.d0;return(0,i.wg)(),(0,i.j4)(g,{modelValue:t.value,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value=e),width:"20%",draggable:"",center:""},{footer:(0,i.w5)((()=>[(0,i._)("span",d,[(0,i.Wm)(r,{onClick:a[0]||(a[0]=e=>t.value=!1)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.cancel")),1)])),_:1}),(0,i.Wm)(r,{type:"primary",onClick:a[1]||(a[1]=e=>u((0,m.SU)(o).name))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.remove")),1)])),_:1})])])),default:(0,i.w5)((()=>[(0,i._)("h2",null,(0,n.zw)(e.$t("message.ImageName"))+" : "+(0,n.zw)((0,m.SU)(o).name),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.TagsCount"))+" : "+(0,n.zw)((0,m.SU)(o).tags_count),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.ImageSizeNoMB"))+" : "+(0,n.zw)((0,m.SU)(o).size)+" (MiB)",1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.ImageFirstCreated"))+" : "+(0,n.zw)((0,m.SU)(o).first_creation),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.ImageLastCredated"))+" : "+(0,n.zw)((0,m.SU)(o).last_creation),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.ImageLastPull"))+" : "+(0,n.zw)((0,m.SU)(o).last_pull),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.ImageLastPush"))+" : "+(0,n.zw)((0,m.SU)(o).last_push),1)])),_:1},8,["modelValue"])}}};const p=w;var _=p;const h={class:"dialog-footer"};var z={__name:"DelTag",setup(e){const a=c(),t=(0,m.iH)(!1);let o=(0,m.qj)({});r.Z.on("delete_tag",(e=>{t.value=!0,o.name=e.name,o.tag=e.row.tag,o.size=e.row.size,o.create_time=e.row.create_time,o.pull_time=e.row.pull_time,o.push_time=e.row.push_time}));const u=async(e,l)=>{console.log("name--",e),a.DelTag(e,l).then((()=>{t.value=!1,g.z8.success("Delete Success")})).catch((()=>{t.value=!1,g.z8.error("Delete Failure")}))};return(e,a)=>{const r=s.mi,g=l.d0;return(0,i.wg)(),(0,i.j4)(g,{modelValue:t.value,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value=e),width:"20%",draggable:"",center:""},{footer:(0,i.w5)((()=>[(0,i._)("span",h,[(0,i.Wm)(r,{onClick:a[0]||(a[0]=a=>e.dialogVisible=!1)},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.cancel")),1)])),_:1}),(0,i.Wm)(r,{type:"primary",onClick:a[1]||(a[1]=e=>u((0,m.SU)(o).name,(0,m.SU)(o).tag))},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.remove")),1)])),_:1})])])),default:(0,i.w5)((()=>[(0,i._)("h2",null,(0,n.zw)(e.$t("message.ImageName"))+" : "+(0,n.zw)((0,m.SU)(o).name),1),(0,i._)("h2",null,(0,n.zw)(e.$t("message.Tag"))+" : "+(0,n.zw)((0,m.SU)(o).tag),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.TagSizeNoMB"))+" : "+(0,n.zw)((0,m.SU)(o).size)+" (MiB)",1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.CreationTime"))+" : "+(0,n.zw)((0,m.SU)(o).create_time),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.PullTime"))+" : "+(0,n.zw)((0,m.SU)(o).pull_time),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.PushTime"))+" : "+(0,n.zw)((0,m.SU)(o).push_time),1)])),_:1},8,["modelValue"])}}};const f=z;var b=f,v=t(9776),y=(t(9404),t(4143)),C=(t(1863),t(4902)),$=(t(3156),t(247)),S=(t(200),t(8061)),k=(t(7952),t(5214),t(9242));const I=e=>((0,i.dD)("data-v-633c552a"),e=e(),(0,i.Cn)(),e),U={m:"4"},W={m:"t-0 b-2"},D={m:"t-0 b-2"},T={m:"t-0 b-2"},P={m:"t-0 b-2"},N={class:"demo-pagination-block",style:{"margin-top":"20px"}},j=I((()=>(0,i._)("div",{id:"image_chart",style:{width:"100%",height:"600px"}},null,-1)));function x(e,a,t,l,m,r){const g=S.$Y,o=s.mi,u=S.eI,c=$.R,d=C.Dv,w=y.Kf,p=v.dq,h=b,z=_;return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,[(0,i.Wm)(p,{justify:"space-between",gutter:"40"},{default:(0,i.w5)((()=>[(0,i.Wm)(d,{span:13},{default:(0,i.w5)((()=>[(0,i.Wm)(u,{data:l.imageStore.images,style:{width:"100%"},"max-height":"800px"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{type:"expand"},{default:(0,i.w5)((a=>[(0,i._)("div",U,[(0,i._)("p",W,(0,n.zw)(e.$t("message.ImageFirstCreated"))+" : "+(0,n.zw)(a.row.timeinfo.first_creation),1),(0,i._)("p",D,(0,n.zw)(e.$t("message.ImageLastCredated"))+" : "+(0,n.zw)(a.row.timeinfo.last_creation),1),(0,i._)("p",T,(0,n.zw)(e.$t("message.ImageLastPush"))+" : "+(0,n.zw)(a.row.timeinfo.last_push),1),(0,i._)("p",P,(0,n.zw)(e.$t("message.ImageLastPull"))+" : "+(0,n.zw)(a.row.timeinfo.last_pull),1),(0,i._)("h3",null,(0,n.zw)(e.$t("message.Tag")),1),(0,i.Wm)(u,{data:a.row.tags,"max-height":"300px"},{default:(0,i.w5)((()=>[(0,i.Wm)(g,{label:e.$t("message.Tag"),prop:"tag",sortable:""},null,8,["label"]),(0,i.Wm)(g,{label:e.$t("message.Size"),prop:"size",sortable:""},null,8,["label"]),(0,i.Wm)(g,{label:e.$t("message.CreationTime"),prop:"create_time",sortable:""},null,8,["label"]),(0,i.Wm)(g,{label:e.$t("message.PullTime"),prop:"pull_time",sortable:""},null,8,["label"]),(0,i.Wm)(g,{label:e.$t("message.PushTime"),prop:"push_time",sortable:""},null,8,["label"]),(0,i.Wm)(g,{fixed:"right",label:e.$t("message.Operation"),width:"120"},{default:(0,i.w5)((t=>[(0,i.Wm)(o,{link:"",type:"primary",size:"small",onClick:(0,k.iM)((e=>l.deletetag(t.row,a.row.name)),["prevent"])},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.remove")),1)])),_:2},1032,["onClick"])])),_:2},1032,["label"])])),_:2},1032,["data"])])])),_:1}),(0,i.Wm)(g,{label:e.$t("message.ImageName"),prop:"name"},null,8,["label"]),(0,i.Wm)(g,{label:e.$t("message.ImageSize"),prop:"size"},null,8,["label"]),(0,i.Wm)(g,{fixed:"right",label:e.$t("message.Operation"),width:"120"},{default:(0,i.w5)((a=>[(0,i.Wm)(o,{link:"",type:"primary",size:"small",onClick:(0,k.iM)((e=>l.deleteimage(a.row)),["prevent"])},{default:(0,i.w5)((()=>[(0,i.Uk)((0,n.zw)(e.$t("message.remove")),1)])),_:2},1032,["onClick"])])),_:1},8,["label"])])),_:1},8,["data"]),(0,i._)("div",N,[(0,i.Wm)(c,{currentPage:l.currentPage,"onUpdate:currentPage":a[0]||(a[0]=e=>l.currentPage=e),"page-size":l.pageSize,"onUpdate:page-size":a[1]||(a[1]=e=>l.pageSize=e),"page-sizes":[3,5,10,20],disabled:l.disabled,background:l.background,layout:"sizes, prev, pager, next",total:l.imageStore.images_total,onSizeChange:l.handleSizeChange,onCurrentChange:l.handleCurrentChange},null,8,["currentPage","page-size","disabled","background","total","onSizeChange","onCurrentChange"])])])),_:1}),(0,i.Wm)(d,{span:11},{default:(0,i.w5)((()=>[(0,i.Wm)(w,{shadow:"hover",style:{height:"600px"}},{default:(0,i.w5)((()=>[j])),_:1})])),_:1})])),_:1})]),(0,i.Wm)(h),(0,i.Wm)(z)],64)}var L=t(543),G=t(542),H=t(6075),q=t(2015),V=t(12),M=t(203),O=t(4978),Z=t(7049),B=t(1264),F=t(4929),E=t(2483);L.D$([G.N,H.N,q.N,V.N,M.N,Z.N,O.T]);var K={name:"ImageList",setup(){let e=(0,B.w)(),a=c();const t=(0,E.yj)();let l="";const s=(0,m.iH)(1),n=(0,m.iH)(5),g=(0,m.iH)(!0),o=(0,m.iH)(!1),u=e=>{a.GetImages(t.query.library,e,0).then((()=>{let e=(0,F.i)(a.getName,a.getCharData);l.setOption(e)}))},d=e=>{a.GetImages(t.query.library,n.value,(s.value-1)*n.value).then((()=>{let e=(0,F.i)(a.getName,a.getCharData);l.setOption(e)}))};function w(e,a){console.log("delete tag row name",e,a),r.Z.emit("delete_tag",{row:e,name:a})}function p(e){r.Z.emit("delete_image",e),console.log("delete image",e)}return r.Z.on("update_charts",(()=>{e.GetLibraryTotal().then((()=>{let a=(0,F.i)(e.getName,e.getCharData);l.setOption(a)}))})),(0,i.bv)((()=>{a.GetImageTotal(t.query.library),a.GetImages(t.query.library,n.value,null).then((()=>{l=L.S1(document.getElementById("image_chart")),window.addEventListener("resize",(()=>{l.resize()})),console.log("getName",a.getName),console.log("charData",a.getCharData);let e=(0,F.i)(a.getName,a.getCharData);l.setOption(e)}))})),{imageStore:a,myEcharts:l,disabled:o,currentPage:s,background:g,pageSize:n,handleCurrentChange:d,handleSizeChange:u,route:t,deletetag:w,deleteimage:p}}},Q=t(89);const Y=(0,Q.Z)(K,[["render",x],["__scopeId","data-v-633c552a"]]);var R=Y}}]);
//# sourceMappingURL=8.fd6d2936.js.map